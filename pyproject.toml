[tool.black]
line-length = 100
target-version = ['py39']
include = '\.pyi?$'
extend-exclude = '''
/(
  # directories
  \.eggs
  | \.git
  | \.hg
  | \.mypy_cache
  | \.tox
  | \.venv
  | _build
  | buck-out
  | build
  | dist
)/
'''

[tool.isort]
profile = "black"
line_length = 100
multi_line_output = 3
include_trailing_comma = true
force_grid_wrap = 0
use_parentheses = true
ensure_newline_before_comments = true

[tool.ruff.lint]
# Global ignores for jaxtyping compatibility
# F821: Undefined name (jaxtyping uses dimension names like "B", "D" in shape strings)
# ANN401: Dynamically typed expressions (jaxtyping annotations are valid but Ruff doesn't understand them)
# F722: Syntax errors in forward annotations (parser warnings from jaxtyping syntax - false positives)
ignore = ["F821", "ANN401", "F722"]

# Note: Ruff parser warnings about jaxtyping syntax in type annotations are expected.
# These are false positives from Ruff's AST parser not understanding jaxtyping's
# string-based shape syntax (e.g., Float[Tensor, "B D 2"]). The code is syntactically
# correct and will run fine - these warnings can be safely ignored.
